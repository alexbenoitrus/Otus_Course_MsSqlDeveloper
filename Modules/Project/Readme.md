# Описание

Проект базы данных CRM для малого и среднего бизнеса с гибкой настройкой и готовыми пресетами для различных направлений бизнеса.
Эта система даёт базовые и простые механизмы CRM без сложных скидок, лояльности и способов коммуникаций.

Во многих сущностях заведено поле ExtrenalId, которое позволит синхронизировать систему через дополнительные модули со внешним система по желанию клиента (ERP, 1C, календари, ФИАС, etc).

Данная БД - экземляр для конкретного клиента. 
В случае SaaS подразумевается разработка отдельной БД с конфигурацией и адресацией в рамках платформы.

Система имеет относительно гибкую настройку за счёт возможно редактирования типов сущностей (подробнее об этом в пункте *Preset*).

**В планах:**

- Основная БД, отвечающая за разроворот клиентских БД и их поддержку
- Система подлючаемых модулей
- Простая аналитика
- Простое ERP
- Лента новостей (внутренняя и внешняя) с комментариями и реакциями
- Механизмы рассылок
- Базовые механизмы лояльности (аля "*Купи 5 чашек молока + 1 в подарок*")

# Сущности

### Person

Участник взаимоотношений в бизнес-процессах.

Тип участника задаётся через PersonType:

- Руководитель
- Менеджер
- Заказчик
- Поставщик
- Потенциальный клиент
- *etc*

### BusinessUnit

Объединение участников бизнес-процесса.

Тип задаётся через *BusinessUnitType*:

- Отдел продаж
- Отдел маркетинга
- Заказчик ООО "Рога и копыта"
- Подрядчик ИП "Смирнова В.А."
- *etc*

Есть возможность объединить участников через дополнительные объединения *AdditionalBusinessUnit*.
Например, участник относится к "Отдел продаж", но так же может быть включён в "Офис на Плющихе", "Покерный клуб", "Рабочая группа по тендеру МТС".

### Product

Продаваемый или закупаемый продукт/товар/услуга.
Через *MeasurementType* указывается тип измерения (поштучный, весовой, pack).

Цену можно указать в

- самой сущности
- *ProductPriceByBusinessUnit* для подразделения (например, услуги парикмахера в VIP салоне должны быть дороже), 
- *ProductPriceByPerson* для отдельного участника (например, у определённого тату-мастера выше цена в виду уровня или у определённого клиента цена ниже из-за договорённостей).

Приоритет цен: Продукт --> По подразделению --> Персональная

А так же цену можно указать через *ProductSpecialPrice*, указав специальную цену на определённый срок (например, повышение цен на 8 марта) и указав уровень применения через *ProductSpecialPriceLevel*:

- Для всех
- Для всех, кроме персональных
- Для всех, кроме персональных и по подразделениям

### Event

Событие.
Любой элемент взаимодействия между участниками.

Тип задаётся через *EventType*:

- Звонок
- Заказ
- Оплата
- Доставка
- Новогодний корпоратив
- Вечер покера
- Холодный звонок
- *etc*

Событие может быть запланировано, это определяется флагом *IsPlanned*.
Через *EventInvite* определяются участники события. 

События ссылаются друг на друга и имеют возможность выстраиваться в цепочку.

### BusinessDirectionType

Тип участника в бизнес-процессе.

Задаётся у типа участника, типа объединения, продукта и события.

- Внутренний (сотрудники отделы)
- Предоставляющий (подрядчики, поставщики)
- Принимающий (клиенты)
- Партнёры (бартер)

### Channel

Канал коммуникации:

- Телефон
- Мобильный телефон
- Email
- SMS
- VK
- Telegram
- *etc*

Верификация канала, идентификатор, разрешения на тип связи задаются для подразделений и участников через *ChannelIdentificatorForBusinessUnit* и *ChannelIdentificatorForPerson* соответственно.

### AddressLevel

Уровень иерархии в пространстве физических адресов.
Участник или объединение участников могут быть привязаны к конкретному уровню
Сами уровни выстраивают иерархию через поле *ParentId*.
Тип уровня задаётся через *AddressLevelType*:

- Край
- Область
- Город
- Улица
- etc

У участника и объединения так же есть поле *AdditionalAddress*, куда можно указать дополнительную информацию об адресе.

### User

Пользователь интерфейса *CRM*.
Обязательно связывается с Участником.
Роль задаётся через *UserRole*:

- Администратор (видит всё)
- Менеджер (видит своё и всё в рамках своих подразделений, а так же по иерархии подразделений вниз)
- Клиент (видит только своё)

Механизм авторизаций находится в *Session*.

### Расширения системы

Хештеги, заметки и прикрепляемые файлы.
Разрешение на их использование для сущности задаётся через соответствующую таблицу с префиксом *Allow*, с указанием *object_id * таблицы, для которой есть разрешение.

Для хранения каких-либо отдельных файлов есть своя отдельная таблица.
В UI будет реализован простой файловый менеджер.

### Preset

Пресеты позволяют на этапе установки экземпляра CRM для клиента произвести тематическую настройку под специфику клиента из заготовленных настроек (типы участников, объединений, товаров, уровней адресов, событий, каналов коммуникаций, пол участника, каналы коммуникаций):

- парикмахерская
- курьерская служба
- доставка еды
- уборка территорий
- кофейня/кафе
- *etc*

В *BasePreset* хранятся базовые настройки, универсальные для всех (каналы коммуникаций, пол участника, уровни специальных цен, роли *User*).

Важно учитывать, что все типы могут настраиваться в UI самим клиентом (например, заведение типов объединений или своя иерархия адресов в рамках города).
